<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <title>IMAGINATION â€” Hub TURBO (IA + YouTube)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    html, body { height:100%; margin:0; background:#000; overflow:hidden; font-family:system-ui, -apple-system, Segoe UI, Roboto, Arial; }
    canvas { display:block; position:fixed; inset:0; z-index:0; }
    #wrap { position:relative; z-index:10; min-height:100%; display:grid; place-items:center; padding:24px; }
    .card { width:min(1100px, 96vw); background:rgba(255,255,255,.05); border-radius:18px; padding:18px; box-shadow:0 12px 40px rgba(0,0,0,.6); backdrop-filter: blur(8px); }
    header { display:flex; justify-content:space-between; align-items:center; gap:12px; padding:6px 8px 12px; }
    h1 { margin:0; font-size:18px; color:#fff; letter-spacing:.3px; }
    .brand { display:flex; align-items:center; gap:10px; }
    .brand .dot { width:10px; height:10px; border-radius:50%; background:#e9e9e9; box-shadow:0 0 12px rgba(255,255,255,.8); }
    .tabs { display:flex; gap:6px; flex-wrap:wrap; }
    .tab-btn { cursor:pointer; border:0; border-radius:12px; padding:10px 14px; background:#e9e9e9; color:#111; font-weight:700; }
    .tab-btn[aria-selected="true"] { background:#111; color:#e9e9e9; outline:1px solid rgba(255,255,255,.2); }
    .panel { display:none; }
    .panel.active { display:block; }
    .embed { width:100%; height: 552px; border-radius:12px; overflow:hidden; }
    @media (max-width:600px){ .embed { height:420px; } }
    #hint { margin-top:8px; font-size:12px; color:#ddd; opacity:.9; }
    .row { display:flex; gap:14px; align-items:center; flex-wrap:wrap; }
    .kicker { font-size:12px; opacity:.9; color:#ddd; }
    .badge { background:rgba(255,255,255,.2); color:#fff; padding:2px 8px; border-radius:999px; font-size:11px; }
    .ground { margin-top:8px; height:6px; background:linear-gradient(90deg, rgba(255,255,255,.3), rgba(255,255,255,.7), rgba(255,255,255,.3)); border-radius:999px; }
  </style>
</head>
<body>
  <canvas id="c"></canvas>
  <div id="wrap">
    <div class="card">
      <header>
        <div class="brand">
          <div class="dot"></div>
          <h1>IMAGINATION â€” Hub TURBO</h1>
        </div>
        <div class="tabs" role="tablist">
          <button class="tab-btn" role="tab" id="tab-ia" aria-selected="true" aria-controls="panel-ia">IA Turbo</button>
          <button class="tab-btn" role="tab" id="tab-yt" aria-selected="false" aria-controls="panel-yt">YouTube</button>
        </div>
      </header>

      <!-- IA Panel -->
      <section id="panel-ia" class="panel active" role="tabpanel" aria-labelledby="tab-ia">
        <div class="row">
          <div class="kicker">
            Visualizador explosivo â€” <span class="badge">modo TURBO ativo</span> â€” tecla P = Play/Pause
          </div>
        </div>
        <div id="hint">A carregar a faixaâ€¦</div>
        <div class="ground" aria-hidden="true"></div>
      </section>

      <!-- YouTube Panel -->
      <section id="panel-yt" class="panel" role="tabpanel" aria-labelledby="tab-yt">
        <div class="row">
          <div class="kicker">
            YouTube embed (nÃ£o reativo â€” iframe bloqueia o acesso ao Ã¡udio).
          </div>
        </div>
        <div class="embed" aria-label="YouTube embed">
          <iframe
            width="100%" height="100%" style="border:0; border-radius:12px;"
            src="https://www.youtube.com/embed/9LVr3gxiD1o?autoplay=1&mute=0"
            title="YouTube video"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            allowfullscreen></iframe>
        </div>
      </section>
    </div>
  </div>

  <script>
  // Tabs
  const tabIA=document.getElementById('tab-ia'), tabYT=document.getElementById('tab-yt');
  const panelIA=document.getElementById('panel-ia'), panelYT=document.getElementById('panel-yt');
  function select(tab){const ia=tab==='ia';tabIA.setAttribute('aria-selected',ia);tabYT.setAttribute('aria-selected',!ia);panelIA.classList.toggle('active',ia);panelYT.classList.toggle('active',!ia);}
  tabIA.onclick=()=>select('ia'); tabYT.onclick=()=>select('yt');

  // Canvas & Visualizador Turbo
  const canvas=document.getElementById('c'), ctx=canvas.getContext('2d');
  let soundIntensity=0, SCATTER=3, particlesWord=[], confetti=[];
  let BAR_COUNT=96, barHeights=[], barPeaks=[];
  let beatCutoff=0, BEAT_DECAY=0.985, BEAT_MIN=0.12;

  function resize(){
    const dpr=Math.max(1,Math.min(window.devicePixelRatio||1,2));
    canvas.width=innerWidth*dpr; canvas.height=innerHeight*dpr;
    canvas.style.width=innerWidth+'px'; canvas.style.height=innerHeight+'px';
    ctx.setTransform(dpr,0,0,dpr,0,0);
    BAR_COUNT=Math.max(64,Math.floor(innerWidth/9));
    barHeights = new Array(BAR_COUNT).fill(0);
    barPeaks = new Array(BAR_COUNT).fill(0);
  }
  window.addEventListener('resize', resize);
  resize();

  // Confetti explosivo
  class Spark {
    constructor(x,y,e) {
      const ang=Math.random()*Math.PI*2, spd=(2+Math.random()*3)*(1+e*2);
      this.x=x; this.y=y; this.vx=Math.cos(ang)*spd; this.vy=Math.sin(ang)*spd;
      this.life=0; this.maxLife=30+Math.random()*40; this.size=2+Math.random()*3; this.h=Math.random()*360;
    }
    update() {
      this.life++;
      this.vx*=0.96;
      this.vy=this.vy*0.96 + 0.08;
      this.x += this.vx;
      this.y += this.vy;
    }
    draw() {
      const a = 1 - (this.life/this.maxLife);
      ctx.fillStyle = `hsla(${this.h},90%,60%,${a})`;
      ctx.fillRect(this.x, this.y, this.size, this.size);
    }
    get dead() { return this.life >= this.maxLife; }
  }
  function spawnBurst(x,y,e) {
    const n = Math.floor(120 + e*300);
    for (let i=0; i<n; i++) confetti.push(new Spark(x, y, e));
  }

  // PartÃ­culas do tÃ­tulo
  class WordParticle {
    constructor(x,y) {
      this.x = this.baseX = x;
      this.y = this.baseY = y;
      this.vx = this.vy = 0;
    }
    update(p) {
      this.x += (this.baseX - this.x)/20 + (Math.random()-0.5)*p;
      this.y += (this.baseY - this.y)/20 + (Math.random()-0.5)*p;
    }
    draw() {
      ctx.fillStyle = `rgba(255,255,255,${0.4 + soundIntensity*0.6})`;
      const sz = 2 + soundIntensity*5;
      ctx.fillRect(this.x, this.y, sz, sz);
    }
  }
  function initWord() {
    ctx.clearRect(0,0,canvas.width,canvas.height);
    ctx.font = 'bold 120px Arial Black';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillStyle = '#fff';
    ctx.fillText('IMAGINATION', innerWidth/2, innerHeight*0.3);
    const img = ctx.getImageData(0,0,innerWidth,innerHeight).data;
    particlesWord = [];
    for (let y=0; y<innerHeight; y+=4) {
      for (let x=0; x<innerWidth; x+=4) {
        if (img[(y*innerWidth + x)*4 + 3] > 128) {
          particlesWord.push(new WordParticle(x,y));
        }
      }
    }
  }
  initWord();

  // Ãudio (IA + Analyser)
  let audio = new Audio(), audioCtx, analyser, dataArray, bufferLength;
  const hint = document.getElementById('hint');
  function setupAudio() {
    if (audioCtx) return;
    audioCtx = new AudioContext();
    analyser = audioCtx.createAnalyser();
    analyser.fftSize = 1024;
    bufferLength = analyser.frequencyBinCount;
    dataArray = new Uint8Array(bufferLength);
    const src = audioCtx.createMediaElementSource(audio);
    src.connect(analyser);
    analyser.connect(audioCtx.destination);
  }
  async function autogen() {
    audio.src = "musica.mp3"; // ou sua fonte real
    setupAudio();
    audio.autoplay = true;
    audio.play()
    .then(() => hint.textContent = "Tocando TURBO ðŸŽ¶")
    .catch(() => hint.textContent = "Autoplay bloqueado â€” pressione P");
  }
  autogen();

  // Anim Loop
  function draw() {
    ctx.clearRect(0,0,innerWidth,innerHeight);

    if (analyser) {
      analyser.getByteFrequencyData(dataArray);
      let bass=0;
      const limit = Math.floor(bufferLength * 0.12);
      for (let i = 0; i < limit; i++) bass += dataArray[i];
      bass /= limit;
      const bassLevel = bass / 255;
      soundIntensity += (bassLevel - soundIntensity) * 0.2;

      if (bassLevel > beatCutoff && bassLevel > BEAT_MIN) {
        beatCutoff = bassLevel * 1.2;
        spawnBurst(innerWidth/2, innerHeight*0.7, bassLevel);
      } else {
        beatCutoff *= BEAT_DECAY;
      }

      const ground = innerHeight * 0.7;
      const gap = 2;
      const barW = (innerWidth - (BAR_COUNT-1)*gap) / BAR_COUNT;

      for (let b = 0; b < BAR_COUNT; b++) {
        const idx = Math.floor(b/BAR_COUNT * bufferLength);
        const v = dataArray[idx] / 255;
        barHeights[b] += (v*innerHeight*0.4 - barHeights[b]) * 0.4;
        barPeaks[b] = Math.max(barPeaks[b], barHeights[b]);
        barPeaks[b] *= 0.98;
        const x = b * (barW + gap);

        ctx.fillStyle = 'rgba(0,200,255,0.8)';
        ctx.fillRect(x, ground - barHeights[b], barW, barHeights[b]);

        ctx.fillStyle = '#fff';
        ctx.fillRect(x, ground - barPeaks[b] - 2, barW, 2);
      }
    }

    particlesWord.forEach(p => { p.update(soundIntensity*10); p.draw(); });

    for (let i = confetti.length - 1; i >= 0; i--) {
      confetti[i].update();
      confetti[i].draw();
      if (confetti[i].dead) confetti.splice(i, 1);
    }

    requestAnimationFrame(draw);
  }
  draw();

  // BotÃ£o P
  window.addEventListener('keydown', e => {
    if (e.key.toLowerCase() === 'p') {
      setupAudio();
      if (audio.paused) audio.play();
      else audio.pause();
    }
  });
  </script>
</body>
</html>
